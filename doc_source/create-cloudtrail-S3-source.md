# Amazon S3 source actions and CloudWatch Events<a name="create-cloudtrail-S3-source"></a>

To add an Amazon S3 source action in CodePipeline, you choose either to: 
+ Use the CodePipeline console **Create pipeline** wizard \([Create a pipeline \(console\)](pipelines-create.md#pipelines-create-console)\) or **Edit action** page to choose the **S3** provider option\. The console creates an Amazon CloudWatch Events rule and a CloudTrail trail that starts your pipeline when the source changes\.
+ Use the CLI to add the action configuration for the `S3` action and create additional resources as follows:
  + Use the `S3` example action configuration in [Amazon S3 source action](action-reference-S3.md) to create your action as shown in [Create a pipeline \(CLI\)](pipelines-create.md#pipelines-create-cli)\.
  + The change detection method defaults to starting the pipeline by polling the source\. You should disable periodic checks and create the change detection rule and trail manually\. Use one of the following methods: [Create a CloudWatch Events rule for an Amazon S3 source \(console\)](create-cloudtrail-S3-source-console.md), [Create a CloudWatch Events rule for an Amazon S3 source \(CLI\)](create-cloudtrail-S3-source-cli.md), or [Create a CloudWatch Events rule for an Amazon S3 source \(AWS CloudFormation template\) ](create-cloudtrail-S3-source-cfn.md)\.

AWS CloudTrail is a service that logs and filters events on your Amazon S3 source bucket\. The trail sends the filtered source changes to the Amazon CloudWatch Events rule\. The Amazon CloudWatch Events rule detects the source change and then starts your pipeline\. 

**Requirements:**
+ If you are not creating a trail, use an existing AWS CloudTrail trail for logging events in your Amazon S3 source bucket and sending filtered events to the Amazon CloudWatch Events rule\.
+ Create or use an existing S3 bucket where AWS CloudTrail can store its log files\. AWS CloudTrail must have the permissions required to deliver log files to an Amazon S3 bucket\. The bucket cannot be configured as a [Requester Pays](https://docs.aws.amazon.com/AmazonS3/latest/dev/RequesterPaysBuckets.html) bucket\. When you create an Amazon S3 bucket as part of creating or updating a trail in the console, AWS CloudTrail attaches the required permissions to a bucket for you\. For more information, see [Amazon S3 Bucket Policy for CloudTrail](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/create-s3-bucket-policy-for-cloudtrail.html)\.